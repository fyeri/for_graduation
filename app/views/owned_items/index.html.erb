<h1><%= t('.ownted_item') %></h1>

<%= form_with url: owned_items_path, method: :get do |form| %>
  <div>
    <%= form.label :name, Item.human_attribute_name(:name) %>
    <%= form.text_field :name %>
  </div>

  <div>
    <%= form.label :character, Item.human_attribute_name(:character) %>
    <%= form.text_field :character %>
  </div>
  <div>
    <%= form.label :label, Item.human_attribute_name(:label_ids) %>
    <%= form.select :label, current_user.labels.collect { |label| [label.name, label.id] }, include_blank: true %>
  </div>

  <div>
    <%= form.submit t('search') %>
  </div>
<% end %>

<table>
  <thead>
    <tr>
      <th><%= Item.human_attribute_name(:image) %></th>
      <th><%= Item.human_attribute_name(:name) %></th>
      <th><%= Item.human_attribute_name(:character) %></th>
      <th><%= Item.human_attribute_name(:category) %></th>
      <th><%= Item.human_attribute_name(:label_ids) %></th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @items.each do |item| %>
      <tr>
        <td>
          <% if item.image.present? %>
            <%= image_tag item.image.url %>
          <% else %>
            <%= image_tag "default.png", size: "200x200" %>
          <% end %>
        </td>
        <td><%= item.name %></td>
        <td><%= item.character %></td>
        <td><%= item.category %></td>
        <td>
          <% item.labels.each do |label| %>
           <%= label.name %>
          <% end %>
        </td>
        <td><%= link_to t('show'), item %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= paginate @items %>

<h2><%= t('.category') %></h2>
<% Item.categories.each do |key, value| %>
  <%= link_to key, items_by_category_path(category: key) %><br>
<% end %>